# Деплой City Wave Multiplayer Server на Railway

## Шаг 1: Создание аккаунта на Railway

1. Перейдите на [railway.app](https://railway.app)
2. Зарегистрируйтесь или войдите в аккаунт
3. Подключите GitHub аккаунт (рекомендуется)

## Шаг 2: Подготовка кода

### Вариант A: Через GitHub (Рекомендуется)

1. Создайте новый репозиторий на GitHub
2. Загрузите папку `multiplayer-server` в репозиторий
3. Убедитесь что файлы включают:
   - `package.json`
   - `server.js`
   - `README.md`
   - `.gitignore`
   - `railway.json`

### Вариант B: Прямая загрузка

1. Зайдите в Railway Dashboard
2. Нажмите "New Project"
3. Выберите "Deploy from GitHub repo" или "Empty Project"

## Шаг 3: Настройка проекта на Railway

1. В Railway Dashboard создайте новый проект
2. Подключите ваш GitHub репозиторий
3. Railway автоматически определит Node.js проект
4. Сервер запустится автоматически

## Шаг 4: Получение URL сервера

1. После успешного деплоя откройте ваш проект в Railway
2. Перейдите в раздел "Settings" > "Domains"
3. Скопируйте сгенерированный URL (например: `https://your-project.up.railway.app`)
4. Обратите внимание: для WebSocket используйте `wss://` вместо `https://`

## Шаг 5: Обновление клиентского кода

Отредактируйте файл `js/multiplayer.js`:

```javascript
getServerUrl() {
    const isLocalhost = window.location.hostname === 'localhost' || 
                       window.location.hostname === '127.0.0.1' ||
                       window.location.hostname === '';
    
    if (isLocalhost) {
        return 'ws://localhost:8080';
    } else {
        // Замените на ваш Railway URL
        return 'wss://ВАШ-ПРОЕКТ.up.railway.app';
    }
}
```

## Шаг 6: Тестирование

1. Загрузите обновленные файлы на ваш веб-сервер
2. Откройте игру в браузере
3. Перейдите в локацию "Park"
4. Проверьте подключение к мультиплееру в консоли разработчика

## Возможные проблемы

### CORS ошибки
Если возникают CORS ошибки, добавьте в `server.js`:
```javascript
// Добавить CORS заголовки (уже включено в код)
```

### SSL/WSS проблемы
Railway автоматически предоставляет SSL сертификаты. Убедитесь что используете `wss://` для WebSocket подключений в продакшене.

### Переменные окружения
Railway автоматически устанавливает переменную `PORT`. Дополнительные переменные можно добавить в Settings > Variables.

## Мониторинг

1. Логи сервера доступны в Railway Dashboard > Deployments
2. Используйте `console.log()` для отладки
3. Проверяйте статус сервера в реальном времени

## Стоимость

Railway предоставляет бесплатный tier с ограничениями:
- 500 часов выполнения в месяц
- $5 кредит при регистрации
- Автоматическое масштабирование

Для продакшена рекомендуется платный план.
